<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Sensors - Mobile Applications for Engineers</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../.././theme/pagetoc.css">
        <link rel="stylesheet" href="../.././theme/css/mdbook-admonish.css">
        <link rel="stylesheet" href="../.././theme/css/code.css">
        <link rel="stylesheet" href="../.././theme/css/terminal.css">
        <link rel="stylesheet" href="../.././theme/css/output.css">
        <link rel="stylesheet" href="../.././theme/css/film.css">
        <link rel="stylesheet" href="../.././theme/css/mdbook-admonish.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="dracula">Dracula</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frapp√©</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="kanagawa">Knagawa</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="pinkrose">Pinkrose</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="tender">Tender</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="tokyonight">Tokyonight</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Mobile Applications for Engineers</h1>

                    <div class="right-buttons">
                        <a href="https://github.com/uniofgreenwich/ELEE1146-COMP1836_Exercises" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/uniofgreenwich/ELEE1146-COMP1836_Exercises/edit/main/content/Kotlin/Lab_10/Lab_10.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main><div class="sidetoc"><nav class="pagetoc"></nav></div>
                        <h1 id="lab-10-all-of-the-sensors"><a class="header" href="#lab-10-all-of-the-sensors">Lab 10 All of the Sensors</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<table style="border-collapse: collapse; border: none; table-layout: fixed; width: 100%;" >
<tr style="border: none;">
<td style="border: none; width:60%;">
<p>In this lab, you will learn how to create an Android application using Jetpack Compose to list and interact with device sensors. You'll use <code>reflection</code> to gather information about available sensors, display it dynamically, and update sensor data in real-time.</p>
</td>
<td style="border: none; width:33%;">
<p><img src="./figures/all_of_the_sensors.gif" alt="" /></p>
</td>
</tr>
</table>
<hr />
<h2 id="step-by-step-instructions"><a class="header" href="#step-by-step-instructions">Step-by-Step Instructions</a></h2>
<h3 id="step-1-set-up-the-project"><a class="header" href="#step-1-set-up-the-project">Step 1: Set Up the Project</a></h3>
<ol>
<li>Open Android Studio and create a new <strong>Empty Compose Activity</strong> project.</li>
<li>Name the project <code>AllOfTheSensors</code>.</li>
<li>Ensure the <code>minSdk</code> is set to <code>24</code> or higher.</li>
<li>Place the following logo into mipmap <a href="./figures/all_of_the_sensors_logo.png">all_of_the_sensors_logo.png</a></li>
</ol>
<hr />
<h3 id="step-2-add-the-required-dependencies"><a class="header" href="#step-2-add-the-required-dependencies">Step 2: Add the Required Dependencies</a></h3>
<p>Ensure the following dependencies are included in the <code>build.gradle</code> file:</p>
<div id="admonition-code" class="admonition admonish-code" role="note" aria-labelledby="admonition-code-title">
<div class="admonition-title">
<div id="admonition-code-title">
<p>Code</p>
</div>
<a class="admonition-anchor-link" href="#admonition-code"></a>
</div>
<div>
<pre><code class="language-gradle">dependencies {
    ...
    implementation(kotlin("reflect"))
}
</code></pre>
</div>
</div>
<hr />
<h3 id="step-3-understand-the-application-structure"><a class="header" href="#step-3-understand-the-application-structure">Step 3: Understand the Application Structure</a></h3>
<p>The app consists of:</p>
<ol>
<li><strong>MainActivity</strong>: Sets up the <code>SensorManager</code> and initializes the Compose UI.</li>
<li><strong>SensorApp</strong>: A composable function to display sensor information.</li>
<li><strong>SensorDropdownMenu</strong>: A dropdown menu for selecting sensors.</li>
<li><strong>RealTimeSensorData</strong>: Displays real-time data from the selected sensor.</li>
<li><strong>Helper Functions</strong>: For retrieving sensor information and handling sensor events.</li>
</ol>
<hr />
<h3 id="step-4-create-the-main-activity"><a class="header" href="#step-4-create-the-main-activity">Step 4: Create the Main Activity</a></h3>
<ol>
<li>
<p>Replace the content of <code>MainActivity.kt</code> with:</p>
<details id="admonition-suppressed-code-14-lines" class="admonition admonish-code" role="note" aria-labelledby="admonition-suppressed-code-14-lines-title">
<summary class="admonition-title">
<div id="admonition-suppressed-code-14-lines-title">
<p>Suppressed code ...[14 lines]</p>
</div>
<a class="admonition-anchor-link" href="#admonition-suppressed-code-14-lines"></a>
</summary>
<div>
<pre><code class="language-kotlin">class MainActivity : ComponentActivity() {
    private var mgr: SensorManager? = null

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        mgr = getSystemService(SENSOR_SERVICE) as SensorManager
        setContent {
            AllOfTheSensorsTheme {
                Surface(color = MaterialTheme.colorScheme.background) {
                    SensorApp(mgr!!)
                }
            }
        }
    }
}
</code></pre>
</div>
</details>
</li>
</ol>
<hr />
<h3 id="step-5-implement-the-sensorapp-composable"><a class="header" href="#step-5-implement-the-sensorapp-composable">Step 5: Implement the <code>SensorApp</code> Composable</a></h3>
<ol>
<li>
<p>Add the <code>SensorApp</code> function in the same file or create a new file for composables.</p>
</li>
<li>
<p>This function initialises UI elements and manages sensor data.</p>
<details id="admonition-suppressed-code-13-lines" class="admonition admonish-code" role="note" aria-labelledby="admonition-suppressed-code-13-lines-title">
<summary class="admonition-title">
<div id="admonition-suppressed-code-13-lines-title">
<p>Suppressed code ...[13 lines]</p>
</div>
<a class="admonition-anchor-link" href="#admonition-suppressed-code-13-lines"></a>
</summary>
<div>
<pre><code class="language-kotlin">...

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun SensorApp(mgr: SensorManager) { 
     val sensorList = rememberSaveable { mutableStateOf(listOf&lt;String&gt;()) }
     val selectedSensor = rememberSaveable { mutableStateOf&lt;String?&gt;(null) }
     val sensorInfo = rememberSaveable { mutableStateOf("") }
     val sensorData = remember { mutableStateOf("No data") }

     LaunchedEffect(Unit) {
         sensorList.value = mgr.getSensorList(Sensor.TYPE_ALL).map { it.name }
     }
}
</code></pre>
</div>
</details>
<div id="admonition-explanation-of-launchedeffect" class="admonition admonish-example" role="note" aria-labelledby="admonition-explanation-of-launchedeffect-title">
<div class="admonition-title">
<div id="admonition-explanation-of-launchedeffect-title">
<p>Explanation of LaunchedEffect</p>
</div>
<a class="admonition-anchor-link" href="#admonition-explanation-of-launchedeffect"></a>
</div>
<div>
<p><code>LaunchedEffect(Unit)</code> is a composable function in Jetpack Compose that is used to run a block of suspendable code when a given key (in this case, Unit) changes or the composable enters the composition.</p>
<ul>
<li>
<p><strong>Side Effects in Compose</strong>: <code>LaunchedEffect</code> is designed to handle side effects safely in the context of the composable lifecycle.</p>
</li>
<li>
<p><strong>Runs Once or When Dependencies Change</strong>: When the provided key(s) change, or when the composable enters the composition for the first time, the lambda inside <code>LaunchedEffect</code> is executed.</p>
</li>
</ul>
</div>
</div>
</li>
<li></li>
</ol>
<hr />
<h3 id="step-6-create-the-sensordropdownmenu-composable"><a class="header" href="#step-6-create-the-sensordropdownmenu-composable">Step 6: Create the <code>SensorDropdownMenu</code> Composable</a></h3>
<ol>
<li>
<p>Define a dropdown menu to list all available sensors.</p>
</li>
<li>
<p>Implement the <code>SensorDropdownMenu</code> function.</p>
 <div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
 <div class="admonition-title">
 <div id="admonition-info-title">
<p>Info</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-info"></a>
 </div>
 <div>
<p>There is nothing new in this code with reference to a <code>DropDownMenu</code></p>
 </div>
 </div>
 <details id="admonition-suppressed-code-34-lines" class="admonition admonish-code" role="note" aria-labelledby="admonition-suppressed-code-34-lines-title">
 <summary class="admonition-title">
 <div id="admonition-suppressed-code-34-lines-title">
<p>Suppressed code ...[34 lines]</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-suppressed-code-34-lines"></a>
 </summary>
 <div>
<pre><code class="language-kt">@Composable
fun SensorDropdownMenu(
    sensorList: List&lt;String&gt;,
    onSensorSelected: (String) -&gt; Unit
) {
    var expanded by rememberSaveable { mutableStateOf(false) }

    Column {
        Button( modifier = Modifier.padding(5.dp,0.dp),
            onClick = { expanded = true }) {
            Text("Select Sensor")
        }

        DropdownMenu(
            expanded = expanded,
            onDismissRequest = { expanded = false },
        ) {
            val scrollState = rememberScrollState()
            Column(modifier = Modifier
                .heightIn(max = 400.dp)
                .verticalScroll(scrollState)) {
                sensorList.forEach { sensorName -&gt;
                    DropdownMenuItem(
                        text = {
                            Text(text = sensorName)
                        },
                        onClick = {
                        onSensorSelected(sensorName)
                        expanded = false
                    })
                }
            }
        }
    }
}
</code></pre>
 </div>
 </details>
</li>
</ol>
<hr />
<h3 id="step-7-add-reflection-to-retrieve-sensor-details"><a class="header" href="#step-7-add-reflection-to-retrieve-sensor-details">Step 7: Add Reflection to Retrieve Sensor Details</a></h3>
<ol>
<li>
<p>Use the <code>getSensorInfo</code> function to extract sensor details using reflection.</p>
</li>
<li>
<p>Understand how Java reflection is applied to get sensor methods dynamically.</p>
 <details id="admonition-suppressed-code-22-lines" class="admonition admonish-code" role="note" aria-labelledby="admonition-suppressed-code-22-lines-title">
 <summary class="admonition-title">
 <div id="admonition-suppressed-code-22-lines-title">
<p>Suppressed code ...[22 lines]</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-suppressed-code-22-lines"></a>
 </summary>
 <div>
<pre><code class="language-kt">fun getSensorInfo(sensorName: String, mgr: SensorManager): String {
    val sensor = mgr.getSensorList(Sensor.TYPE_ALL).find { it.name == sensorName }
    sensor?.let {
        val stringBuilder = StringBuilder()
        for (method in it.javaClass.methods) {
            try {
                val result = if (method.parameterTypes.isEmpty()) {
                    method.invoke(it)
                } else {
                    "N/A"
                }
                if (method.parameterCount == 0 ) {
                    stringBuilder.append(method.name).append(": ")
                        .append(result).append("\n")
                }
            } catch (e: Exception) {
                stringBuilder.append(method.name).append(": Error\n")
            }
        }
        return stringBuilder.toString()
    }
    return "Sensor not found"
}
</code></pre>
 </div>
 </details>
 <div id="admonition-explanation-of-reflection-in-the-code" class="admonition admonish-example" role="note" aria-labelledby="admonition-explanation-of-reflection-in-the-code-title">
 <div class="admonition-title">
 <div id="admonition-explanation-of-reflection-in-the-code-title">
<p>Explanation of reflection in the code</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-explanation-of-reflection-in-the-code"></a>
 </div>
 <div>
<ul>
<li>
<p><code>it.javaClass.methods</code>: Retrieves all public methods of the sensor object as an array.</p>
</li>
<li>
<p><strong>Iteration</strong>: For each method, the code inspects and invokes it.</p>
<ul>
<li>
<p><code>method.parameterTypes.isEmpty()</code>: Checks if the method has no parameters. This is important because invoking methods with parameters dynamically would require additional inputs and setup.</p>
</li>
<li>
<p><code>method.invoke(it)</code>: If the method has no parameters, it is called (invoked) on the sensor object (<code>it</code>). The result of the method is stored in <code>result</code>.</p>
</li>
<li>
<p><code>method.parameterCount == 0</code>: Ensures only methods with zero parameters are appended to the <code>StringBuilder</code>.</p>
</li>
</ul>
</li>
</ul>
 </div>
 </div>
</li>
</ol>
<hr />
<h3 id="step-8-handle-real-time-sensor-data"><a class="header" href="#step-8-handle-real-time-sensor-data">Step 8: Handle Real-Time Sensor Data</a></h3>
<ol>
<li>
<p>Implement <code>RealTimeSensorData</code> to display updated sensor data.</p>
</li>
<li>
<p>Use <code>DisposableEffect</code> to register and unregister listeners.</p>
 <details id="admonition-suppressed-code-16-lines" class="admonition admonish-code" role="note" aria-labelledby="admonition-suppressed-code-16-lines-title">
 <summary class="admonition-title">
 <div id="admonition-suppressed-code-16-lines-title">
<p>Suppressed code ...[16 lines]</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-suppressed-code-16-lines"></a>
 </summary>
 <div>
<pre><code class="language-kt">@Composable
fun RealTimeSensorData(sensorName: String?, mgr: SensorManager, sensorData: MutableState&lt;String&gt;) {
    if (sensorName != null) {
        val sensor = mgr.getSensorList(Sensor.TYPE_ALL).find { it.name == sensorName }
        sensor?.let {
            val sensorEventListener = remember { createSensorEventListener(sensorData) }
            DisposableEffect(sensor) {
                mgr.registerListener(sensorEventListener,
                    sensor,
                    SensorManager.SENSOR_DELAY_NORMAL)
                onDispose {
                    mgr.unregisterListener(sensorEventListener)
                }
            }
        }
    }
}
</code></pre>
 </div>
 </details>
 <div id="admonition-explanation-of-disposableeffect" class="admonition admonish-example" role="note" aria-labelledby="admonition-explanation-of-disposableeffect-title">
 <div class="admonition-title">
 <div id="admonition-explanation-of-disposableeffect-title">
<p>Explanation of DisposableEffect(..)</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-explanation-of-disposableeffect"></a>
 </div>
 <div>
<p><code>DisposableEffect</code> is a composable function in Jetpack Compose that is used to manage resources or side effects that need cleanup when the composable leaves the composition. It's particularly useful for scenarios like registering listeners or observers, where you need to ensure proper cleanup to avoid memory leaks or unintended behavior.</p>
<ul>
<li>
<p>Setup (<code>registerListener</code>):</p>
<ul>
<li>The <code>DisposableEffect</code> block is triggered when the sensor is selected (i.e., when the sensor key changes).</li>
<li>It registers a <code>SensorEventListener</code> to start receiving data from the sensor.</li>
</ul>
</li>
<li>
<p>Cleanup (<code>unregisterListener</code>):</p>
<ul>
<li>The <code>onDispose</code> block is called when the composable leaves the composition or the sensor key changes.</li>
<li>The <code>SensorEventListener</code> is unregistered to ensure no further updates are received from the sensor.</li>
</ul>
</li>
</ul>
<p>Without <code>DisposableEffect</code>, you‚Äôd need to manually manage the setup and cleanup outside of the composable lifecycle, which increases the risk of errors like memory leaks or dangling listeners. With <code>DisposableEffect</code>, you can keep the setup and cleanup logic co-located and ensure proper lifecycle management automatically.</p>
 </div>
 </div>
</li>
</ol>
<hr />
<h3 id="step-9-createsensoreventlistener"><a class="header" href="#step-9-createsensoreventlistener">Step 9: createSensorEventListener(...)</a></h3>
<ol>
<li>
<p>Implement <code>createSensorEventListener</code> to monitor sensor events.</p>
 <details id="admonition-suppressed-code-11-lines" class="admonition admonish-code" role="note" aria-labelledby="admonition-suppressed-code-11-lines-title">
 <summary class="admonition-title">
 <div id="admonition-suppressed-code-11-lines-title">
<p>Suppressed code ...[11 lines]</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-suppressed-code-11-lines"></a>
 </summary>
 <div>
<pre><code class="language-kt">fun createSensorEventListener(sensorData: MutableState&lt;String&gt;): SensorEventListener {
    return object : SensorEventListener {
        override fun onSensorChanged(event: SensorEvent) {
            val data = event.values.joinToString(", ") { it.toString() }
            sensorData.value = "Sensor data: $data"
        }

        override fun onAccuracyChanged(sensor: Sensor, accuracy: Int) {
            // Handle accuracy changes if needed
        }
    }
}
</code></pre>
 </div>
 </details>
 <div id="admonition-explanation-of-sensor-functions" class="admonition admonish-example" role="note" aria-labelledby="admonition-explanation-of-sensor-functions-title">
 <div class="admonition-title">
 <div id="admonition-explanation-of-sensor-functions-title">
<p>Explanation of Sensor functions</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-explanation-of-sensor-functions"></a>
 </div>
 <div>
<ul>
<li>
<p><code>override</code> keyword indicates that a method in a class is overriding a method or function declared in a superclass or interface</p>
<ul>
<li>
<p>The <code>SensorEventListener</code> is an interface provided by the Android framework for monitoring sensor events. It has two methods that must be implemented:</p>
<ul>
<li>
<p><code>onSensorChanged(SensorEvent event)</code> is called when the sensor provides new data.</p>
</li>
<li>
<p>The <code>onAccuracyChanged(Sensor sensor, int accuracy)</code> is called when the sensor's accuracy changes.</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>If you don't <code>override</code> these methods:</p>
<ul>
<li>These compiler would throw an error because you're implementing the <code>SensorEventListener</code> interface, which requires these methods.</li>
<li>Without providing a custom implementation, the interface-defined methods would remain unimplemented, resulting in incomplete functionality.</li>
</ul>
</li>
</ul>
 </div>
 </div>
</li>
</ol>
<hr />
<h3 id="step-10-composables-for-sensorapp"><a class="header" href="#step-10-composables-for-sensorapp">Step 10: Composables for SensorApp()</a></h3>
<ol>
<li>
<p>Revisit the function <code>SensorApp(...){}</code> and after <code>LaunchedEffect(...){...}</code></p>
</li>
<li><details id="admonition-suppressed-code-62-lines" class="admonition admonish-code" role="note" aria-labelledby="admonition-suppressed-code-62-lines-title">
<summary class="admonition-title">
<div id="admonition-suppressed-code-62-lines-title">
<p>Suppressed code... [62 lines]</p>
</div>
<a class="admonition-anchor-link" href="#admonition-suppressed-code-62-lines"></a>
</summary>
<div>
<pre><code class="language-kt">...
Scaffold(topBar = {
    TopAppBar(
        title = {Text("All of the Sensors")},
        navigationIcon = {
            Image(painter = painterResource(id = R.mipmap.all_of_the_sensors_logo),
                contentDescription = "Logo for all of the sensors" ,
                modifier = Modifier.size(80.dp))
        }
    ) }
)
{ paddingValues -&gt;
    Column(
        modifier = Modifier
            .fillMaxWidth()
            .padding(paddingValues)
            .padding(16.dp)
    ) {
        Row(){
            Text(
                text = "Sensors Count: ${sensorList.value.size}",
                style = MaterialTheme.typography.headlineSmall)
            Spacer(modifier = Modifier.width(20.dp))
            SensorDropdownMenu(
                sensorList = sensorList.value,
                onSensorSelected = { sensorName -&gt;
                    selectedSensor.value = sensorName
                    sensorInfo.value = getSensorInfo(sensorName, mgr)
                    sensorData.value = "Fetching data..."
                }
            )
        }

        Spacer(modifier = Modifier.height(16.dp))
        Text(text = "Selected Sensor:\n  ${selectedSensor.value.toString()}")
        Box(
            modifier = Modifier
                .fillMaxWidth()
                .size(510.dp)
                .border(
                    Dp(2f),
                    shape = RectangleShape,
                    color = Color.Black
                )
        ) {
            Text(
                text = sensorInfo.value,
                style = MaterialTheme.typography.bodySmall,
                modifier = Modifier.padding(10.dp)
            )
        }

        Spacer(modifier = Modifier.height(16.dp))

        RealTimeSensorData(
            sensorName = selectedSensor.value,
            mgr = mgr,
            sensorData = sensorData
        )

        Text(text = sensorData.value,
            style = MaterialTheme.typography.bodyMedium)
    }
}
...
</code></pre>
</div>
</details>
</li>
</ol>
<h3 id="step-11-run-the-app"><a class="header" href="#step-11-run-the-app">Step 11: Run the App</a></h3>
<ol>
<li>Connect a device or use an emulator.</li>
<li>Build and run the app.</li>
<li>Verify that sensors are listed and real-time data updates when a sensor is selected.</li>
</ol>
<h3 id="full-code-if-you-are-struggling"><a class="header" href="#full-code-if-you-are-struggling">Full Code, if you are struggling</a></h3>
<details id="admonition-full-code-supressed-here-mainactivtykt--217-lines" class="admonition admonish-code" role="note" aria-labelledby="admonition-full-code-supressed-here-mainactivtykt--217-lines-title">
<summary class="admonition-title">
<div id="admonition-full-code-supressed-here-mainactivtykt--217-lines-title">
<p>Full code supressed here, MainActivty.kt ... [217 lines]</p>
</div>
<a class="admonition-anchor-link" href="#admonition-full-code-supressed-here-mainactivtykt--217-lines"></a>
</summary>
<div>
<pre><code class="language-kt">package com.uog.allofthesensors

import android.hardware.Sensor
import android.hardware.SensorEvent
import android.hardware.SensorEventListener
import android.hardware.SensorManager
import android.os.Bundle
import androidx.activity.ComponentActivity
import androidx.activity.compose.setContent
import androidx.compose.foundation.Image
import androidx.compose.foundation.border
import androidx.compose.foundation.layout.*
import androidx.compose.foundation.rememberScrollState
import androidx.compose.foundation.verticalScroll
import androidx.compose.material3.*
import androidx.compose.runtime.*
import androidx.compose.runtime.saveable.rememberSaveable
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.graphics.RectangleShape
import androidx.compose.ui.res.painterResource
import androidx.compose.ui.tooling.preview.Preview
import androidx.compose.ui.unit.Dp
import androidx.compose.ui.unit.dp
import com.uog.allofthesensors.ui.theme.AllOfTheSensorsTheme

class MainActivity : ComponentActivity() {
    private var mgr: SensorManager? = null

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        mgr = getSystemService(SENSOR_SERVICE) as SensorManager
        setContent {
            AllOfTheSensorsTheme {
                Surface(color = MaterialTheme.colorScheme.background){
                    SensorApp(mgr!!)
                }
            }
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun SensorApp(mgr: SensorManager) {
    val sensorList = rememberSaveable { mutableStateOf(listOf&lt;String&gt;()) }
    val selectedSensor = rememberSaveable { mutableStateOf&lt;String?&gt;(null) }
    val sensorInfo = rememberSaveable { mutableStateOf("") }
    val sensorData = remember { mutableStateOf("No data") }

    LaunchedEffect(Unit) {
        sensorList.value = mgr.getSensorList(Sensor.TYPE_ALL).map { it.name }
    }

    Scaffold(topBar = {
        TopAppBar(
            title = {Text("All of the Sensors")},
            navigationIcon = {
                Image(painter = painterResource(id = R.mipmap.all_of_the_sensors_logo),
                    contentDescription = "Logo for all of the sensors" ,
                    modifier = Modifier.size(80.dp))
            }
        ) }
    )
    { paddingValues -&gt;
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(paddingValues)
                .padding(16.dp)
        ) {
            Row(){
                Text(
                    text = "Sensors Count: ${sensorList.value.size}",
                    style = MaterialTheme.typography.headlineSmall)
                Spacer(modifier = Modifier.width(20.dp))
                SensorDropdownMenu(
                    sensorList = sensorList.value,
                    onSensorSelected = { sensorName -&gt;
                        selectedSensor.value = sensorName
                        sensorInfo.value = getSensorInfo(sensorName, mgr)
                        sensorData.value = "Fetching data..."
                    }
                )
            }

            Spacer(modifier = Modifier.height(16.dp))
            Text(text = "Selected Sensor:\n  ${selectedSensor.value.toString()}")
            Box(
                modifier = Modifier
                    .fillMaxWidth()
                    .size(510.dp)
                    .border(
                        Dp(2f),
                        shape = RectangleShape,
                        color = Color.Black
                    )
            ) {
                Text(
                    text = sensorInfo.value,
                    style = MaterialTheme.typography.bodySmall,
                    modifier = Modifier.padding(10.dp)
                )
            }

            Spacer(modifier = Modifier.height(16.dp))

            RealTimeSensorData(
                sensorName = selectedSensor.value,
                mgr = mgr,
                sensorData = sensorData
            )

            Text(text = sensorData.value,
                style = MaterialTheme.typography.bodyMedium)
        }
    }
}

@Composable
fun SensorDropdownMenu(
    sensorList: List&lt;String&gt;,
    onSensorSelected: (String) -&gt; Unit
) {
    var expanded by rememberSaveable { mutableStateOf(false) }

    Column {
        Button( modifier = Modifier.padding(5.dp,0.dp),
            onClick = { expanded = true }) {
            Text("Select Sensor")
        }

        DropdownMenu(
            expanded = expanded,
            onDismissRequest = { expanded = false },
        ) {
            val scrollState = rememberScrollState()
            Column(modifier = Modifier
                .heightIn(max = 400.dp)
                .verticalScroll(scrollState)) {
                sensorList.forEach { sensorName -&gt;
                    DropdownMenuItem(
                        text = {
                            Text(text = sensorName)
                        },
                        onClick = {
                        onSensorSelected(sensorName)
                        expanded = false
                    })
                }
            }
        }
    }
}

fun getSensorInfo(sensorName: String, mgr: SensorManager): String {
    val sensor = mgr.getSensorList(Sensor.TYPE_ALL).find { it.name == sensorName }
    sensor?.let {
        val stringBuilder = StringBuilder()
        for (method in it.javaClass.methods) {
            try {
                val result = if (method.parameterTypes.isEmpty()) {
                    method.invoke(it)
                } else {
                    "N/A"
                }
                if (method.parameterCount == 0 ) {
                    stringBuilder.append(method.name).append(": ")
                        .append(result).append("\n")
                }
            } catch (e: Exception) {
                stringBuilder.append(method.name).append(": Error\n")
            }
        }
        return stringBuilder.toString()
    }
    return "Sensor not found"
}

@Composable
fun RealTimeSensorData(sensorName: String?, mgr: SensorManager, sensorData: MutableState&lt;String&gt;) {
    if (sensorName != null) {
        val sensor = mgr.getSensorList(Sensor.TYPE_ALL).find { it.name == sensorName }
        sensor?.let {
            val sensorEventListener = remember { createSensorEventListener(sensorData) }
            DisposableEffect(sensor) {
                mgr.registerListener(sensorEventListener,
                    sensor,
                    SensorManager.SENSOR_DELAY_NORMAL)
                onDispose {
                    mgr.unregisterListener(sensorEventListener)
                }
            }
        }
    }
}

fun createSensorEventListener(sensorData: MutableState&lt;String&gt;): SensorEventListener {
    return object : SensorEventListener {
        override fun onSensorChanged(event: SensorEvent) {
            val data = event.values.joinToString(", ") { it.toString() }
            sensorData.value = "Sensor data: $data"
        }

        override fun onAccuracyChanged(sensor: Sensor, accuracy: Int) {
            // Handle accuracy changes if needed
        }
    }
}

@Composable
@Preview(showBackground = true)
fun SensorAppPreview() {
    val mgr: SensorManager? = null
    AllOfTheSensorsTheme {
        SensorApp(mgr!!)
    }
}
</code></pre>
</div>
</details><style>.scroll-to-top { font-size: 2.5rem; width: 3.2rem; height: 3.2rem; display: none; align-items: center; justify-content: center; position: fixed; padding: 0.75rem; bottom: 4rem; right: calc(1.25rem + 90px + var(--page-padding)); z-index: 999; cursor: pointer; border: none; color: var(--bg); background: var(--fg); border-radius: 50%; } .scroll-to-top.hidden { display: none; } .scroll-to-top i { transform: translateY(-2px); } @media (min-width: 1080px) { .scroll-to-top { display: flex; } }</style><button type="button" aria-label="scroll-to-top" class="scroll-to-top hidden" onclick="scrollToTop()"> <i class="fa fa-angle-up"></i></button><script>const scrollToTop = () => window.scroll({ top: 0, behavior: "smooth" }); window.addEventListener("scroll", () => { const button = document.querySelector(".scroll-to-top"); button.classList.toggle("hidden", window.scrollY <200); });</script><style>footer { text-align: center; text-wrap: balance; margin-top: 5rem; display: flex; flex-direction: column; justify-content: center; align-items: center; } footer p { margin: 0; }</style><footer><p>Copyright ¬© 2025 ‚Ä¢ Created with ‚ù§Ô∏è by <a href="https://github.com/CompEng0001">CompEng0001</a></p></footer>
<footer><span class="gitinfo-footer" style="font-size:0.8em;padding:4px;margin:0.5em 0;text-align:right;display:block;">Page last updated: Thursday 26 June 2025 @ 14:13:52 | Commit: 15c04c1</span></footer>
                    </main>
                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../Kotlin/Lab_9/Lab_9.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../Kotlin/Lab_9/Lab_9.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../.././theme/pagetoc.js"></script>
        <script src="../.././theme/highlightjs-line-numbers.js"></script>


    </div>
    </body>
</html>